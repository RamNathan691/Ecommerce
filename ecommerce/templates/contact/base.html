

<html>
<head>
<title>
base page
</title>
 {% include 'base/css.html'%}
</head>

<body> 
{% include 'base/navbar.html' with site_name="Telebury"  %}
<div class="container">
{% block content %}
{% endblock %}
</div>
<script>
$(document).ready(function(){
    var productForm=$(".product-add-ajax")
    productForm.submit(function(event){
        event.preventDefault();
        console.log("I made the form not to submit")

        var thisform=$(this)
        var actionEndpoint=thisform.attr("action");
        var httpMethod=thisform.attr("method");
        var formData=thisform.serialize();

        $.ajax({
            url:actionEndpoint,
            method:httpMethod,
            data:formData,
            success:function(data){
             var submitSpan=thisform.find(".submit-span")
             if(data.added){
                 submitSpan.html("In Cart<button type='submit' class='btn btn-link'>Remove??</button>")
             }
             else{
                 submitSpan.html("<button type='submit' class='btn btn-success'>Add to cart</button>")
             }
             var navbarcartcount=$(".navbar-cart-count")
             navbarcartcount.text(data.cartItemCount)
            },
            error:function(errorData){
                console.log("error")
                console.log(errorData)
            }
        })
    })
})
</script>
</body>
</html>